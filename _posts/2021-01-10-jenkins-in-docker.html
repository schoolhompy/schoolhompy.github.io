---
layout: post
title: Jenkins in docker  , 젠킨스 도커 이미지 커스터마이징 하기
date: '2021-01-10T01:58:00.000-08:00'
author: schoolhompy
tags:
- docker
- jenkins
modified_time: '2021-01-10T01:58:01.818-08:00'
blogger_id: tag:blogger.com,1999:blog-4954243635432022205.post-9172068062594628587
blogger_orig_url: https://yunhos.blogspot.com/2021/01/jenkins-in-docker.html
---

<p>&nbsp;1.jenkins 기본 이미지를 가져오는 Dockerfile 을 만든다&nbsp;</p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">FROM jenkins/jenkins:lts</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">MAINTAINER amola@amola.co.kr</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">USER root</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><br /></span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><br /></span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">RUN apt-get update &amp;&amp; \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>apt-get -y install apt-transport-https \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>ca-certificates \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>curl \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>gnupg2 \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>software-properties-common &amp;&amp; \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>curl -fsSL https://download.docker.com/linux/$(. /etc/os-release; echo "$ID")/gpg &gt; /tmp/dkey; apt-key add /tmp/dkey &amp;&amp; \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>add-apt-repository \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>"deb [arch=amd64] https://download.docker.com/linux/$(. /etc/os-release; echo "$ID") \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>$(lsb_release -cs) \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>stable" &amp;&amp; \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp;&nbsp; </span>apt-get update &amp;&amp; \</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp;&nbsp; </span>apt-get -y install docker-ce</span></p><p class="p2" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px; min-height: 14px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"></span></p><p class="p2" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px; min-height: 14px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"></span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">VOLUME /var/android_sdk</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><br /></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"># install jenkins plugins</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">COPY mydummyplugins.txt /usr/share/jenkins/ref/mydummyplugins.txt</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">RUN /usr/local/bin/install-plugins.sh<span class="Apple-converted-space">&nbsp; </span>&lt; /usr/share/jenkins/ref/mydummyplugins.txt</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><br /></span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">#Update the username and password</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">ENV JENKINS_USER admin</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"></span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">ENV JENKINS_PASS ThisIs@StrongP@ssword</span></p><div><br /></div>2.jenkins plugin 을 컨테이너 만들때 마다&nbsp; 일일히 선택하기 싫으니까&nbsp; mydummyplugins.txt라는 파일을 만들어서 컨테이너 생성시에 젠킨스의 install-plugins.sh 스크립트로 플러그인을 미리 설치한다. 이렇게 하면 처음 젠킨스 설정시에 플러그인이 설치과저이 빠르게 지나간다.<div>젠킨스 초기설정시에&nbsp; 따로 플러그인을 선택하고자 한다면 위의 두줄을 # 로 주석처리함.</div><div><br /></div><div>mydummyplugins.txt 에 설치할 플러그인의 이름을 다 입력해놓아야 하는데, 그많은 플러그인을 알수가 없기에, 일단 젠킨스 기본이미지로 만든 젠킨스 컨테이너를 설치후 젠킨스플러그인화면에서 이런저런 플러그인을 설치후, groovy 스크립트로 플러그인 목록을 가져와서 mydummyplugins.txt에 넣어주면 된다.</div><div><br /></div><div>설치된 젠킨스 컨테이너로 들어가서 젠킨스사이트에서&nbsp;Manage Jenkins-&gt;Tools and Actions-&gt;Script Console 로 들어가서&nbsp;</div><div><br /></div><div>Jenkins.instance.pluginManager.plugins.each{&nbsp;</div><div>&nbsp; plugin -&gt; println("${plugin.getShortName()}")&nbsp;</div><div>}</div><div><br /></div><div>실행하면&nbsp;</div><div><h2 style="background-color: white; box-sizing: inherit; color: #333333; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 1.75rem; line-height: var(--line-height-heading); margin-bottom: 0.5rem; margin-top: 0.5rem;">Result</h2><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">ace-editor<br />ant<br />antisamy-markup-formatter<br />apache-httpcomponents-client-4-api<br />bootstrap4-api<br />bouncycastle-api<br />branch-api<br />build-timeout<br />checks-api<br />cloudbees-folder<br />command-launcher<br />config-file-provider<br />credentials-binding</pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">...</pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;"><br /></pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">이렇게 나오는데, 이걸 복사해서 로컬의 mydummyplugins.txt 에  복사해서 넣는다.</pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;"><br /></pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">mydummyplugins</pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">-------------------</pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;"><pre style="box-sizing: inherit; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">ace-editor<br />ant<br />antisamy-markup-formatter<br />apache-httpcomponents-client-4-api<br />bootstrap4-api<br />bouncycastle-api<br />...........</pre></pre><pre style="background-color: white; box-sizing: inherit; color: #333333; font-size: var(--font-size-monospace); margin-bottom: 0px; margin-top: 0px; overflow-wrap: break-word; white-space: pre-wrap;">-------------</pre></div><div><br /></div><div>참고사이트 :&nbsp;<br />https://web.plus-idea.net/2019/07/plugin-pre-installed-jenkins-docker/ <br />https://www.digitalocean.com/community/tutorials/how-to-automate-jenkins-setup-with-docker-and-jenkins-configuration-as-code<br /><br />감사요!</div><div><br /></div><div><br /></div><div>3. dockerfile 을 빌드해서 이미지를 만들자.</div><div><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">docker build -t jenkinstest/myjenkins:1.0 .</span></p></div><div>-t 는 tag 옵션으로 생성할 이미지 이름이다. 클론 뒤에는 버젼을 쓴다. 맨 마지막에는 DockerFile이 있는 위치이다.</div><div>혹시 잘 안되면 빌드 캐시 삭제</div><span style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-variant-ligatures: no-common-ligatures;">docker builder prune</span><div><br /></div><div><br /></div><div>3-1. docker-compose.yml 파일로 빌드와 실행을 동시에.</div><div><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">version: '3'</span></p><p class="p2" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px; min-height: 14px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"></span><br /></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">services:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; </span>jenkins:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>build:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>context: .</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>dockerfile: Dockerfile</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>container_name: 'jenkins_docker_myjenkins'</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>restart: always</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>ports:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- '8200:8080'</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- '50200:50000'</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>expose:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- '8080'</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- '50000'</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; </span>volumes:</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- /var/jenkins_home</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;"><span class="Apple-converted-space">&nbsp; &nbsp; &nbsp; </span>- /var/android_sdk</span></p></div><div><br /></div><div>build: 옵션에 의해 composer 를 기동하면 현재 폴더(.)의 Dockerfile을 읽어와서 빌드를 하고 'jenkins_docker_taehokim' 이름으로 컨테이너를 기동한다. 또한 기동시에 포트와 볼륨을 지정한다.일단 볼륨은 로컬사용자에 따라 다르게 지정하도록 정의만 해놓았지만,&nbsp;</div><div>- ~/myjenkins_homedir:/var/jenkins_home</div><div>- /Library/android_sdk:/var/android_sdk</div><div>식으로 컴포저파일에 지정해도 된다.</div><div><br /></div><div>4.빌드가 성공적으로 끝났다면,&nbsp; jenkins기본이미지를 바탕으로 Dockerfile에 지정된 내용대로 나만의 jenkins이미지가 만들어져있을것이다. 생성된 이미지는 고유의 ID를 가지고있다.</div><div>jenkinstest/taehoandroid<span style="white-space: pre;">	</span>&nbsp;|<span style="white-space: pre;">	</span>1.0<span style="white-space: pre;">	</span>|&nbsp;ac9b0dfd1d35</div><div><br /></div><div>5.자 이미지가 있으니 몇개라도 젠킨스 컨테이너를 만들수 있다. docker run 으로 실행하자.</div><div><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">docker run -d \&nbsp;</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">-p 8082:8080 \&nbsp;</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">-v ~/docker_share:/var/jenkins_home \&nbsp;</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">-v ~/Library/Android/sdk:/var/android_sdk \&nbsp;</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">--name tesetdel2 \&nbsp;</span></p><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">jenkinstest/myjenkins:1.0</span></p></div><div><br /></div><div>5-1. 저 명령어들을 매번 치자니 귀찮다.&nbsp; 도커컴포저를 만들어서 설정값을 넣어두면 간단하게 실행할수 있다.</div><div><p class="p1" style="background-color: rgba(0, 0, 0, 0.9); color: #2fff12; font-family: D2Coding; font-size: 12px; font-stretch: normal; font-variant-east-asian: normal; font-variant-numeric: normal; line-height: normal; margin: 0px;"><span class="s1" style="font-variant-ligatures: no-common-ligatures;">sudo docker-compose up -d<span class="Apple-converted-space">&nbsp;</span></span></p></div><div><br /></div><div><br /></div><div>6.젠킨스 컨테이너가 8082로 떠 있을테니, localhost:8082 로 접속한다.</div><div>(초기 암호는 여기에..&nbsp;cat /var/jenkins_home/secrets/initialAdminPassword)</div><div><br /></div><div>7.젠킨스 플러그인 설치가 이미지 빌드시에 다 끝났기 때문에 , 초기 설정시간이 짧아졌다.</div><div><br /></div><div><br /></div>