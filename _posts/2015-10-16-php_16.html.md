---
layout: post
title: PHP 의존성 주입 예제
date: '2015-10-16T18:17:00.001-07:00'
author: schoolhompy
tags:
- php
modified_time: '2017-06-25T02:22:53.415-07:00'
blogger_id: tag:blogger.com,1999:blog-4954243635432022205.post-8259892109696257028
blogger_orig_url: https://yunhos.blogspot.com/2015/10/php_16.html
---

이해가 되는 슬라이드<br/><br/>http://www.slideshare.net/rifat/dependency-injection-10624875?qid=5def2560-b50b-4e50-8592-cb7d4d077516&amp;v=qf1&amp;b=&amp;from_search=6<br/><br/>&nbsp;<br/><br/>http://modernpug.github.io/php-the-right-way/#dependency_injection 에서 발췌<br/><div id="dependency_injection"><br/><h1 id="dependency_injection_title">의존성 주입</h1><br/><a href="http://ko.wikipedia.org/wiki/%EC%9D%98%EC%A1%B4%EC%84%B1_%EC%A3%BC%EC%9E%85">위키백과에서 인용</a>:<br/><blockquote>의존성 주입(Dependency Injection, DI)은 프로그래밍에서 구성요소간의 종속성을 소스코드에서 설정하지 않고 외부의 설정파일 등을 통해 컴파일 시점이나 실행 시점에 주입하도록 하는 디자인 패턴 중의 하나이다.</blockquote><br/>위와 같은 설명은 실제보다 훨씬 어렵게 느껴지게 만드는 점이 있습니다. 의존성 주입이라는 것은 특정 컴포넌트의 의존 관계를, 생성자에서 주입하거나 메소드 호출 혹은 프로퍼티 설정을 하는 방식으로 지정할 수 있게 하는 것입니다. 간단한 얘기입니다.<br/><br/></div><br/><div id="basic_concept"><br/><h2 id="basic_concept_title">기본 개념</h2><br/>간단한 예제를 통해서 기본적인 개념을 보여드리겠습니다.<br/><br/>아래 코드를 보면 데이터베이스와 통신하기 위한 어댑터를 필요로 하는 <code>Database</code>라는 클래스가 있습니다. 생성자에서 어댑터 인스턴스를 생성하는 방식으로 되어 있어서 두 클래스는 서로 강한 의존 관계를 가지고 있습니다. 그래서 <code>Database</code> 클래스를 테스트하기도 어렵습니다.<br/><div class="highlight"><br/><pre><code class="language-php"><span class="cp">&lt;?php</span><br/><span class="k">namespace</span> <span class="nx">Database</span><span class="p">;</span><br/><br/><span class="k">class</span> <span class="nc">Database</span><br/><span class="p">{</span><br/>    <span class="k">protected</span> <span class="nv">$adapter</span><span class="p">;</span><br/><br/>    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span><br/>    <span class="p">{</span><br/>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySqlAdapter</span><span class="p">;</span><br/>    <span class="p">}</span><br/><span class="p">}</span><br/><br/><span class="k">class</span> <span class="nc">MysqlAdapter</span> <span class="p">{}</span></code></pre><br/></div><br/>아래와 같이 리팩터링하여 의존성 주입을 사용하도록 하면 의존 관계를 약화시킬 수 있습니다.<br/><div class="highlight"><br/><pre><code class="language-php"><span class="cp">&lt;?php</span><br/><span class="k">namespace</span> <span class="nx">Database</span><span class="p">;</span><br/><br/><span class="k">class</span> <span class="nc">Database</span><br/><span class="p">{</span><br/>    <span class="k">protected</span> <span class="nv">$adapter</span><span class="p">;</span><br/><br/>    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">MySqlAdapter</span> <span class="nv">$adapter</span><span class="p">)</span><br/>    <span class="p">{</span><br/>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">adapter</span> <span class="o">=</span> <span class="nv">$adapter</span><span class="p">;</span><br/>    <span class="p">}</span><br/><span class="p">}</span><br/><br/><span class="k">class</span> <span class="nc">MysqlAdapter</span> <span class="p">{}</span></code></pre><br/></div><br/>이제 <code>Database</code>는 내부에서 직접 의존 관계에 있는 클래스 인스턴스를 생성하지 않고, 외부에서 전달받게 되었습니다. 어댑터 인스턴스를 인자로 전달받는 메소드를 만들어서 해당 어댑터를 사용하도록 설정하는 방식을 적용하거나, <code>$adapter</code> 프로퍼티를<code>public</code> 으로 만들어서 프로퍼티를 직접 설정하게 할 수도 있을 것입니다.<br/><br/></div>